{"componentChunkName":"component---src-templates-blog-post-js","path":"/signing-your-commits-in-git/","result":{"data":{"site":{"siteMetadata":{"title":"Mario Fernandez","description":"This is the blog from Mario Fernandez, a Software Developer working for ThoughtWorks","author":"Mario Fernandez","url":"https://hceris.com","twitter":"@sirech"}},"post":{"id":"f2d36934-0b3d-5027-a3bb-e24f83acc8d7","html":"<figure class=\"figure figure--left\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/654382f4a08cd04837d237fc787f0acb/eea4a/signature.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.48936170212765%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEEAgP/xAAVAQEBAAAAAAAAAAAAAAAAAAACAf/aAAwDAQACEAMQAAABrWWVQcSL/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAESEwIRIf/aAAgBAQABBQJorxK9kmSbE+f/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAwEBPwGH/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8Bp//EABgQAAMBAQAAAAAAAAAAAAAAAAABMREg/9oACAEBAAY/Aoa0Xj//xAAaEAEBAQEAAwAAAAAAAAAAAAABAEEhETGh/9oACAEBAAE/IfL7+IEyOSeuoPbRMT//2gAMAwEAAgADAAAAEMTP/8QAFhEBAQEAAAAAAAAAAAAAAAAAACEB/9oACAEDAQE/EMpX/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/EE2l/8QAGhABAQACAwAAAAAAAAAAAAAAAREAITFRYf/aAAgBAQABPxA3AbiwZBvE9TIVNNNucS06d4lah0awQCh45//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Signature\" title=\"\" src=\"/static/654382f4a08cd04837d237fc787f0acb/acb04/signature.jpg\" srcset=\"/static/654382f4a08cd04837d237fc787f0acb/bc01b/signature.jpg 188w,\n/static/654382f4a08cd04837d237fc787f0acb/bf173/signature.jpg 375w,\n/static/654382f4a08cd04837d237fc787f0acb/acb04/signature.jpg 750w,\n/static/654382f4a08cd04837d237fc787f0acb/ec605/signature.jpg 1125w,\n/static/654382f4a08cd04837d237fc787f0acb/eea4a/signature.jpg 1280w\" sizes=\"(max-width: 750px) 100vw, 750px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <figcaption class=\"figure__caption\">\n  We'll need your signature, mister\n  </figcaption>\n</figure>\n<p>I’ve gotten into the habit at work of signing my commits in <code class=\"language-text\">git</code> with my <a href=\"https://gnupg.org/\" target=\"_blank\" rel=\"noopener noreferrer\">GPG key</a>. It adds an extra layer of integrity to the source code, as it enables us to know who produced each commit (if the practice is followed widely).</p>\n<p>It requires some initial configuration, but after that, it adds very little overhead.</p>\n<p>Even if your organization doesn’t have a policy requiring it, I think it’s still worth setting up. Let’s see how to do it.</p>\n<p>Even if it’s not required by your organization’s policies, I think it’s still worth setting up. Let’s see how to do it.</p>\n<h2>What do I need?</h2>\n<p>At the risk of being obvious, you need a <code class=\"language-text\">gpg</code> key. You might have one already if you sign your emails or store secrets in <a href=\"../storing-passwords-with-gopass/\">gopass</a>.</p>\n<p>If not, you need to create one first. Don’t worry, it’s free and not too painful. I learned from a colleague to keep my key in a Yubikey. <a href=\"https://support.yubico.com/hc/en-us/articles/360013790259-Using-Your-YubiKey-with-OpenPGP\" target=\"_blank\" rel=\"noopener noreferrer\">Check this guide</a> if you want to know how to do this.</p>\n<h2>Setting up the git configuration</h2>\n<p>I’m keeping work-related repositories in a different folder, using a <a href=\"https://github.com/sirech/shell/blob/master/git/gitconfig#L173-L174\" target=\"_blank\" rel=\"noopener noreferrer\">conditional configuration</a>. I recommend it because you split cleanly between work and personal stuff. <a href=\"https://heiber.im/posts/git-client-configurations-for-multiple-identities/\" target=\"_blank\" rel=\"noopener noreferrer\">This post</a> contains extra details.</p>\n<p>My configuration, imported from the main <code class=\"language-text\">~/.gitconfig</code>, resides in <code class=\"language-text\">~/work/gitconfig</code>. It enables commit signing for every repository in that folder.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>user<span class=\"token punctuation\">]</span>\n  email <span class=\"token operator\">=</span> my@work-email.com\n  signingkey <span class=\"token operator\">=</span> 7C58C79F397ED302595958045F0F068E59529E71\n<span class=\"token punctuation\">[</span>commit<span class=\"token punctuation\">]</span>\n  gpgsign <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span></code></pre></div>\n<p>The email needs to match with the one assigned to the key. You can see the id of your key by running <code class=\"language-text\">gpg --list-keys</code>. Try to commit something: you’ll get asked for the passphrase of your <code class=\"language-text\">gpg</code> key.</p>\n<h2>Visualizing signatures</h2>\n<p>There is a flag for <code class=\"language-text\">git log</code> that displays whether a commit is correctly signed (<code class=\"language-text\">%G?</code>). I use the following alias:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">lg = log --pretty=format':%C(yellow)%h%Cred%d%Creset %C(green)%G?%Creset %s %C(cyan) %an, %ar%Creset'</code></pre></div>\n<p>An excerpt of the commit history looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">43d4e36 (HEAD -> master) N fix typo  Mario Fernandez, 13 hours ago\nb433463 (origin/master, origin/HEAD) N add on call talk  Mario Fernandez, 4 days ago\naae0b0c U Merge pull request #870 from sirech/dependabot/npm_and_yarn/eslint-7.22.0  dependabot-preview[bot], 7 days ago</code></pre></div>\n<p>There is a single letter after the commit hash and branch that provides information about the signature. <code class=\"language-text\">N</code> means unsigned, and <code class=\"language-text\">U</code> means good signature with unknown validity. You can also show the signatures as part of the log output for extra details:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[log]\n    showSignature = true</code></pre></div>\n<h3>Github</h3>\n<p>You can visualize this information in Github directly. You can add your <code class=\"language-text\">gpg</code> key following <a href=\"https://docs.github.com/en/github/authenticating-to-github/managing-commit-signature-verification\" target=\"_blank\" rel=\"noopener noreferrer\">these instructions</a>. It will end up looking like this:</p>\n<figure class=\"figure\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/deb6b708179c50ff7fccea056f319853/1cfc2/github-config.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 50.53191489361703%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABfUlEQVR42o1Sy47UMBCc//8IvoADd05w43FAghujZVfs7NiTZJLYbj9jF+pOJmLgspZatpPuclVXH0IIGIYr5nlGaw2lFCil0Q+D3F+z3h3f482Pt5iTxcF7D2sd6lZcawWRh3MER7Tu+9lJcP7tbIxBylnqmcDB+4Dr9YpWGygRUslIJeEyXKCVxjwbGGMhDzMIEZZlkYf34HspK+AqeRAWta0JMSeMZsK5U9DDBd3Yw5HDNM3IOf8nueSEFPzGMAT0fY+U0i455yKFPma4UOFCEYbko9ytL1iWKgD1nz5vkkcYa3cJ1lph/FpTvqrv+PD7M3wJqyncWAbixf3RWqPrOmF9C2YcY7wL/s77p9M3fHz+AsobIBezc2VZhJXI9R7jOGE2qyn8n/v9N2AIUSbiTnJwVuaQnWZ2vIgILy9n/Dwe8fj0hIdfj3g+naCUgtIa4zTJg7f8nCIiERoaDjxL57PaJfPODecCdpXZ8aiwUffsggC2bf64jl3+A/DzB/hifPF7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"A configured GPG key on Github\" title=\"\" src=\"/static/deb6b708179c50ff7fccea056f319853/1d69c/github-config.png\" srcset=\"/static/deb6b708179c50ff7fccea056f319853/4dcb9/github-config.png 188w,\n/static/deb6b708179c50ff7fccea056f319853/5ff7e/github-config.png 375w,\n/static/deb6b708179c50ff7fccea056f319853/1d69c/github-config.png 750w,\n/static/deb6b708179c50ff7fccea056f319853/1cfc2/github-config.png 900w\" sizes=\"(max-width: 750px) 100vw, 750px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n</figure>\n<p>Github displays information about verified commits directly on its UI. It does a good of making this information visual and accessible.</p>\n<figure class=\"figure\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/a4eeeba1d4ba380a87f7f5eaeba622aa/c6bbc/github-verified.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 32.97872340425532%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABPElEQVR42mWR227bMBBE9f8fWKBJo9S2LhR1oUSLong9hRmjSdoF5m33YGa2UuvGpjXmOHHec7oPuad8iMSYiCkTrCVc3kkxEjKcIRFzxsdMiJGUEtWP1xu3pqURC03Xc7m19INEyIlODKx6x57+QzFj61/cf9fITnB9u6C6HiUm7rsthqqX946uaxnkjBzHom3b2I3hOA5CCOScPwVsUnJtGuprzU10mHHBHpYYI9XrEygGiZQjg5SodS0w731Z+grLIbAPI/OsGUfFYQx2Vk9gonqpW/q+R06KcZyYl4Xd7Oy7QWuNc+67w5yJu+HcNu7LjF0UetGlkuLw51tL2zYIIUpcfb+TcuLr/At8zOMZhz+xzqPNo2NXHlNduwkph+JsXTcWpUrUx2FK+T/YX5cp4rwru/YMeB9K5D/+KRuIkMhQRgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Checking a verified commit on Github\" title=\"\" src=\"/static/a4eeeba1d4ba380a87f7f5eaeba622aa/1d69c/github-verified.png\" srcset=\"/static/a4eeeba1d4ba380a87f7f5eaeba622aa/4dcb9/github-verified.png 188w,\n/static/a4eeeba1d4ba380a87f7f5eaeba622aa/5ff7e/github-verified.png 375w,\n/static/a4eeeba1d4ba380a87f7f5eaeba622aa/1d69c/github-verified.png 750w,\n/static/a4eeeba1d4ba380a87f7f5eaeba622aa/c6bbc/github-verified.png 910w\" sizes=\"(max-width: 750px) 100vw, 750px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n</figure>\n<h2>That’s it?</h2>\n<p>Yes! If you don’t already have a <code class=\"language-text\">gpg</code> key, there is a bit of work involved. Honestly, you should probably have one. Adding some extra configuration and separating your config a bit is a good investment. Let’s make our delivery a bit more secure, a small step at a time.</p>","frontmatter":{"layout":"post","title":"Signing your commits in git","path":"/signing-your-commits-in-git/","categories":["Security","git","gpg"],"date":"2021/03/22","draft":false,"description":"Signing your commits with a gpg key adds a layer of integrity to your code contributions. Not only that, but it's quite easy to set up","canonical":null,"image":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#b8b8b8","images":{"fallback":{"src":"/static/654382f4a08cd04837d237fc787f0acb/7284f/signature.jpg","srcSet":"/static/654382f4a08cd04837d237fc787f0acb/2d550/signature.jpg 188w,\n/static/654382f4a08cd04837d237fc787f0acb/e4b93/signature.jpg 375w,\n/static/654382f4a08cd04837d237fc787f0acb/7284f/signature.jpg 750w","sizes":"(min-width: 750px) 750px, 100vw"},"sources":[{"srcSet":"/static/654382f4a08cd04837d237fc787f0acb/99097/signature.webp 188w,\n/static/654382f4a08cd04837d237fc787f0acb/7dad0/signature.webp 375w,\n/static/654382f4a08cd04837d237fc787f0acb/57584/signature.webp 750w","type":"image/webp","sizes":"(min-width: 750px) 750px, 100vw"}]},"width":750,"height":500}}}}},"related":{"nodes":[{"frontmatter":{"title":"Storing team passwords with gopass","path":"/storing-passwords-with-gopass/","date":"2018/04/15"}},{"frontmatter":{"title":"Book Review: Securing DevOps","path":"/book-review-securing-devops/","date":"2020/05/26"}}]},"previous":{"frontmatter":{"title":"Book Review: Accelerate","path":"/book-review-accelerate/","date":"2021/03/07"}},"next":{"frontmatter":{"title":"How not to do a take-home coding assignment","path":"/how-not-to-do-a-take-home-coding-assignment/","date":"2021/04/05"}}},"pageContext":{"related":["/storing-passwords-with-gopass/","/book-review-securing-devops/"],"previous":"/book-review-accelerate/","next":"/how-not-to-do-a-take-home-coding-assignment/"}},"staticQueryHashes":[],"slicesMap":{}}